define(function(i){var e=i("app"),t=i("backbone"),n=i("marionette"),s=i("notification"),o=t.Marionette.LayoutView.extend({el:".main-stage",regions:{mainRegion:"#main_region"},views:{LOGIN:"loginView",REGISTER:"registerView"},viewInstances:{},viewsReady:0,viewsToBeReady:1,initialize:function(){this.initViewListeners(),this.initViews(),this.render()},initViewListeners:function(){this.listenTo(this.model,"change:currentView",this.showRegionView,this),this.listenTo(e.vent,s.event.SECTION_READY,this.countSectionsReady)},initViews:function(){this.initLoginView()},initLoginView:function(){var i=e.mapper.getViewFor(this.views.LOGIN);this.viewInstances.loginView=this.loginView=new i({id:"loginView",model:this.model.get("login")}),this.model.set("currentView","loginView")},initRegisterView:function(){var i=e.mapper.getViewFor(this.views.REGISTER);this.viewInstances.registerView=this.registerView=new i({id:"registerView",model:this.model.get("register")}),this.model.set("currentView","registerView")},showRegionView:function(){this.mainRegion.show(this.viewInstances[this.model.get("currentView")])},finalize:function(){e.model.set("appReady",!0),e.global.hideLoader(),e.log.info("application ready")},countSectionsReady:function(){this.viewsReady++,this.viewsReady==this.viewsToBeReady&&this.finalize()},render:function(){}});return o});